<!-- Modern Cricket Analytics Dashboard HTML -->
<nav class="top-nav">
  <div class="nav-container">
    <div class="nav-left">
      <div class="logo-container">
        <div class="logo-icon">
          üèè
        </div>
        <h1 class="site-title">Cricket Analytics</h1>
      </div>
    </div>
    <!-- Desktop Navigation -->
    <div class="nav-right desktop-nav">
      <button class="btn btn-upload" (click)="toggleUploadModal()" [title]="'Upload Match Files'">
        <svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7,10 12,15 17,10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        <span>Upload</span>
      </button>
      <button class="btn btn-primary" (click)="openPartnershipFailures()">
        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 12l2 2 4-4"/>
          <circle cx="12" cy="12" r="10"/>
        </svg>
        Partnership Failures
      </button>
    </div>
    <!-- Mobile Hamburger -->
    <button class="hamburger mobile-only" (click)="toggleMobileMenu()" [class.active]="mobileMenuOpen">
  <span></span>
  <span></span>
  <span></span>
</button>
  </div>
  <!-- Mobile Menu Overlay -->
  <div class="mobile-menu-overlay" [class.active]="mobileMenuOpen" (click)="closeMobileMenu()">
    <div class="mobile-menu" (click)="$event.stopPropagation()">
      <div class="mobile-menu-header">
        <h3>Menu</h3>
        <button class="close-mobile-menu" (click)="closeMobileMenu()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="mobile-menu-items">
        <button class="mobile-menu-item" (click)="toggleUploadModal(); closeMobileMenu()">
          <svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7,10 12,15 17,10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Upload Files
        </button>
        <button class="mobile-menu-item" (click)="openPartnershipFailures(); closeMobileMenu()">
          <svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 12l2 2 4-4"/>
            <circle cx="12" cy="12" r="10"/>
          </svg>
          Partnership Failures
        </button>
      </div>
    </div>
  </div>
</nav>


<!-- Parameter Selection Modal -->
<!-- <div *ngIf="showParameterSelectionModal" class="modal-overlay">
  <div class="modal-content parameter-selection-modal">
    <div class="modal-header">
      <div class="header-info">
        <h2>Partnership Failure Analysis</h2>
        <p class="subtitle">Configure analysis parameters</p>
      </div>
      <button class="close-btn" (click)="closeParameterSelectionModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="parameter-section">
        <div class="parameter-card">
          <div class="parameter-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
          </div>
          <div class="parameter-content">
            <label for="runs-select" class="parameter-label">Minimum Runs Threshold</label>
            <p class="parameter-description">Partnerships below this run count will be considered failures</p>
            <select id="runs-select" class="parameter-select" [(ngModel)]="selectedRuns">
              <option *ngFor="let run of runsOptions" [value]="run">{{ run }} runs</option>
            </select>
          </div>
        </div>

        <div class="parameter-card">
          <div class="parameter-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
              <line x1="3" y1="6" x2="21" y2="6"/>
              <path d="m16 10-4 4-4-4"/>
            </svg>
          </div>
          <div class="parameter-content">
            <label for="wickets-select" class="parameter-label">Number of Wickets to Check</label>
            <p class="parameter-description">Analyze partnerships from 1st wicket to selected wicket</p>
            <select id="wickets-select" class="parameter-select" [(ngModel)]="selectedWickets">
              <option *ngFor="let wicket of wicketsOptions" [value]="wicket">First {{ wicket }} wicket{{ wicket > 1 ? 's' : '' }}</option>
            </select>
          </div>
        </div>
      </div>

      <div class="parameter-summary">
        <div class="summary-card">
          <h4>Analysis Summary</h4>
          <p>Looking for innings where <strong>none of the first {{ selectedWickets }} partnerships</strong> reached <strong>{{ selectedRuns }} runs or more</strong>.</p>
          <p class="summary-note">A partnership of exactly {{ selectedRuns }} runs or more will <em>not</em> be counted as a failure.</p>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeParameterSelectionModal()">Cancel</button>
      <button class="btn btn-primary" (click)="analyzePartnershipFailures()">
        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 12l2 2 4-4"/>
          <circle cx="12" cy="12" r="10"/>
        </svg>
        Analyze Failures
      </button>
    </div>
  </div>
</div> -->


<!-- Parameter Selection Modal -->
<div *ngIf="showParameterSelectionModal" class="modal-overlay">
  <div class="modal-content parameter-selection-modal">
    <div class="modal-header">
      <div class="header-info">
        <h2>Partnership Failure Analysis</h2>
        <p class="subtitle">Configure analysis parameters</p>
      </div>
      <button class="close-btn" (click)="closeParameterSelectionModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    
    <!-- Loading State -->
    <div *ngIf="loadingMatchesForAnalysis" class="modal-body loading-state">
      <div class="loading-container">
        <div class="loading-spinner"></div>
        <h3>Loading Match Data...</h3>
        <p>Please wait while we fetch the tournament data for analysis.</p>
      </div>
    </div>

    <!-- Parameter Selection (when not loading) -->
    <div *ngIf="!loadingMatchesForAnalysis" class="modal-body">
      <div class="parameter-section">
        <div class="parameter-card">
          <!-- <div class="parameter-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
          </div> -->
          <div class="parameter-content">
            <label for="runs-select" class="parameter-label">Minimum Runs Threshold</label>
            <p class="parameter-description">Partnerships below this run count will be considered failures</p>
            <select id="runs-select" class="parameter-select" [(ngModel)]="selectedRuns">
              <option *ngFor="let run of runsOptions" [value]="run">{{ run }} runs</option>
            </select>
          </div>
        </div>

        <div class="parameter-card">
          <!-- <div class="parameter-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
              <line x1="3" y1="6" x2="21" y2="6"/>
              <path d="m16 10-4 4-4-4"/>
            </svg>
          </div> -->
          <div class="parameter-content">
            <label for="wickets-select" class="parameter-label">Number of Wickets to Check</label>
            <p class="parameter-description">Analyze partnerships from 1st wicket to selected wicket</p>
            <select id="wickets-select" class="parameter-select" [(ngModel)]="selectedWickets">
              <option *ngFor="let wicket of wicketsOptions" [value]="wicket">First {{ wicket }} wicket{{ wicket > 1 ? 's' : '' }}</option>
            </select>
          </div>
        </div>
      </div>

      <div class="parameter-summary">
        <!-- <div class="summary-card">
          <h4>Analysis Summary</h4>
          <p>Looking for innings where <strong>none of the first {{ selectedWickets }} partnerships</strong> reached <strong>{{ selectedRuns }} runs or more</strong>.</p>
          <p class="summary-note">A partnership of exactly {{ selectedRuns }} runs or more will <em>not</em> be counted as a failure.</p>
        </div> -->
      </div>
    </div>

    <div *ngIf="!loadingMatchesForAnalysis" class="modal-footer">
      <button class="btn btn-primary" (click)="analyzePartnershipFailures()">
        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 12l2 2 4-4"/>
          <circle cx="12" cy="12" r="10"/>
        </svg>
        Analyze Failures
      </button>
            <button class="btn btn-secondary" (click)="closeParameterSelectionModal()">Cancel</button>

    </div>
  </div>
</div>

<!-- Upload Modal -->
<div class="modal-overlay" *ngIf="showUploadModal" (click)="closeUploadModal()">
  <div class="modal-content upload-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Upload Match JSON Files</h3>
      <button class="close-btn" (click)="closeUploadModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="file-upload-area">
        <input type="file" 
               id="fileInput"
               (change)="onFilesSelected($event)" 
               multiple 
               webkitdirectory 
               directory 
               class="file-input-hidden" />
        <label for="fileInput" class="file-upload-label">
          <div class="upload-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
            </svg>
          </div>
          <h4>Select Folder</h4>
          <p>Choose a folder containing JSON files</p>
        </label>
      </div>
      
      <div class="selected-files" *ngIf="selectedFiles.length > 0">
        <div class="files-count">
          <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
            <polyline points="14,2 14,8 20,8"/>
          </svg>
          <span><strong>{{selectedFiles.length}}</strong> files selected</span>
        </div>
        <div class="file-preview" *ngIf="selectedFiles.length <= 10">
          <div class="file-item" *ngFor="let file of selectedFiles.slice(0, 5)">
            <svg class="file-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
              <polyline points="14,2 14,8 20,8"/>
            </svg>
            <span>{{file.name}}</span>
          </div>
          <div *ngIf="selectedFiles.length > 5" class="more-files">
            +{{selectedFiles.length - 5}} more files
          </div>
        </div>
      </div>
      
      <div class="upload-progress" *ngIf="uploading">
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="uploadProgress"></div>
        </div>
        <p class="progress-text">{{uploadMessage}}</p>
      </div>
      
      <div class="upload-status" *ngIf="uploadMessage && !uploading" 
           [class.success]="uploadMessage.includes('successful')" 
           [class.error]="uploadMessage.includes('failed')">
        <svg *ngIf="uploadMessage.includes('successful')" class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
          <polyline points="22,4 12,14.01 9,11.01"/>
        </svg>
        <svg *ngIf="uploadMessage.includes('failed')" class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <line x1="15" y1="9" x2="9" y2="15"/>
          <line x1="9" y1="9" x2="15" y2="15"/>
        </svg>
        <span>{{uploadMessage}}</span>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeUploadModal()" [disabled]="uploading">
        Cancel
      </button>
      <button class="btn btn-primary" (click)="uploadFiles()" [disabled]="uploading || selectedFiles.length === 0">
        <svg *ngIf="uploading" class="loading-spinner icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12a9 9 0 11-6.219-8.56"/>
        </svg>
        <svg *ngIf="!uploading" class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7,10 12,15 17,10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        <span>{{uploading ? 'Uploading...' : 'Upload Files'}}</span>
      </button>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="main-container">
<!-- Filters Section - Complete -->
<div class="filters-section">
  <div class="section-header">
    <div class="header-content">
      <!-- <svg class="section-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"/>
        <line x1="21" y1="21" x2="16.65" y2="16.65"/>
      </svg> -->
<h2 style="font-size: 1.3rem; background: linear-gradient(135deg, #3b82f6, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; color: transparent;">Browse Matches</h2>    </div>
  </div>

  <!-- Filters Grid -->
  <div class="filters-grid">
    <!-- Tournament Filter -->
    <div class="filter-group">
      <label for="tournament">Tournament</label>
      <div class="select-wrapper" [class.loading]="loadingTournaments">
        <select id="tournament" [(ngModel)]="selectedTournamentId" (change)="onTournamentChange()" [disabled]="loadingTournaments || tournaments.length === 0">
          <option [ngValue]="null" disabled selected>{{ getTournamentPlaceholder() }}</option>
          <option *ngFor="let t of tournaments" [value]="t.id">{{ t.name }}</option>
        </select>
        <div class="select-icon">
          <svg *ngIf="!loadingTournaments" class="select-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
          <div *ngIf="loadingTournaments" class="mini-spinner"></div>
        </div>
      </div>
    </div>

    <!-- Year Filter -->
    <div class="filter-group">
      <label for="year">Year</label>
      <div class="select-wrapper" [class.loading]="loadingYears">
        <select id="year" [(ngModel)]="selectedYear" (change)="onYearChange()" [disabled]="!selectedTournamentId || loadingYears || years.length === 0">
          <option [ngValue]="null" disabled selected>{{ getYearPlaceholder() }}</option>
          <option *ngFor="let y of years" [value]="y">{{ y }}</option>
        </select>
        <div class="select-icon">
          <svg *ngIf="!loadingYears" class="select-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
          <div *ngIf="loadingYears" class="mini-spinner"></div>
        </div>
      </div>
    </div>

    <!-- Team Filter -->
    <div class="filter-group">
      <label for="team">Team</label>
      <div class="select-wrapper" [class.loading]="loadingMatches">
        <select id="team" [(ngModel)]="selectedTeam" (change)="applyMatchFilters()" [disabled]="!selectedYear || loadingMatches || availableTeams.length === 0">
          <option value="">{{ getTeamPlaceholder() }}</option>
          <option *ngFor="let t of availableTeams" [value]="t">{{ t }}</option>
        </select>
        <div class="select-icon">
          <svg *ngIf="!loadingMatches" class="select-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
          <div *ngIf="loadingMatches" class="mini-spinner"></div>
        </div>
      </div>
    </div>

    <!-- Venue Filter -->
    <div class="filter-group">
      <label for="venue">Venue</label>
      <div class="select-wrapper" [class.loading]="loadingMatches">
        <select id="venue" [(ngModel)]="selectedVenue" (change)="applyMatchFilters()" [disabled]="!selectedYear || loadingMatches || availableVenues.length === 0">
          <option value="">{{ getVenuePlaceholder() }}</option>
          <option *ngFor="let v of availableVenues" [value]="v">{{ v }}</option>
        </select>
        <div class="select-icon">
          <svg *ngIf="!loadingMatches" class="select-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
          <div *ngIf="loadingMatches" class="mini-spinner"></div>
        </div>
      </div>
    </div>

    <!-- Match Filter -->
    <div class="filter-group">
      <label for="match">Match</label>
      <div class="select-wrapper" [class.loading]="loadingMatches">
        <select id="match" [(ngModel)]="selectedMatchId" (change)="onMatchChange()" [disabled]="!selectedYear || loadingMatches || matches.length === 0">
          <option [ngValue]="null" disabled selected>{{ getMatchPlaceholder() }}</option>
          <option *ngFor="let m of matches" [value]="m.id">
            {{ m.teams ? (m.teams[0] + ' vs ' + m.teams[1]) : m.matchId }}
          </option>
        </select>
        <div class="select-icon">
          <svg *ngIf="!loadingMatches" class="select-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
          <div *ngIf="loadingMatches" class="mini-spinner"></div>
        </div>
      </div>
    </div>

    <!-- View Type Filter -->
    <div class="filter-group">
      <label for="viewType">View Type</label>
      <div class="select-wrapper" [class.loading]="loadingMatchDetails">
        <select id="viewType" [(ngModel)]="selectedViewType" (change)="onViewTypeChange()" [disabled]="!selectedMatchId || loadingMatchDetails">
          <option [ngValue]="null" disabled>{{ getViewTypePlaceholder() }}</option>
          <option value="partnership">Partnership</option>
          <option value="scorecard">Scorecard</option>
        </select>
        <div class="select-icon">
          <svg *ngIf="!loadingMatchDetails" class="select-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
          <div *ngIf="loadingMatchDetails" class="mini-spinner"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Clear Filters Section -->
  <!-- <div class="filters-actions">
    <button class="btn btn-clear-filters" (click)="clearAllFilters()" [disabled]="!hasActiveFilters()">
      <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 6h18"/>
        <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/>
        <path d="M10 11v6"/>
        <path d="M14 11v6"/>
      </svg>
      Clear All Filters
    </button>
  </div> -->
</div>

<!-- Match Details Section -->
  <div *ngIf="matchDetails && selectedViewType !== 'partnership'" class="match-summary-section">
    <div class="match-card">
      <div class="match-header">
        <div class="teams-display">
          <div class="team">{{ matchDetails.info.teams[0] }}</div>
          <div class="vs-badge">VS</div>
          <div class="team">{{ matchDetails.info.teams[1] }}</div>
        </div>
        <div class="match-result" [class.win]="isWinner()" [class.loss]="!isWinner()">
          {{ matchResult }}
        </div>
      </div>

      <div class="scores-container">
        <div class="score-item" *ngFor="let score of getTeamScores(); let i = index" [class.team-a]="i === 0" [class.team-b]="i === 1">
          {{ score }}
        </div>
      </div>

      <div class="match-details">
        <div class="detail-item">
          <svg class="detail-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
          <span><strong>Venue:</strong> {{ matchDetails.info.venue }}, {{ matchDetails.info.city }}</span>
        </div>
        <div class="detail-item">
          <svg class="detail-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
          </svg>
          <span><strong>Date:</strong> {{ matchDetails.info.dates[0] | date: 'd MMM yyyy' }}</span>
        </div>
        <div class="detail-item">
          <svg class="detail-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6"/>
          </svg>
          <span><strong>Toss:</strong> {{ matchDetails.info.toss.winner }} chose to {{ matchDetails.info.toss.decision }}</span>
        </div>
        <div class="detail-item">
          <svg class="detail-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12,6 12,12 16,14"/>
          </svg>
          <span><strong>Overs:</strong> {{ matchDetails.info.overs }} overs</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Partnership View -->
  <div *ngIf="matchDetails && selectedViewType === 'partnership'" class="partnership-layout">
    <div class="partnership-sidebar">
      <div class="match-card compact">
        <div class="match-header">
          <div class="teams-display">
            <div class="team">{{ matchDetails.info.teams[0] }}</div>
            <div class="vs-badge">VS</div>
            <div class="team">{{ matchDetails.info.teams[1] }}</div>
          </div>
          <div class="match-result" [class.win]="isWinner()" [class.loss]="!isWinner()">
            {{ matchResult }}
          </div>
        </div>

        <div class="scores-container">
          <div class="score-item" *ngFor="let score of getTeamScores(); let i = index" [class.team-a]="i === 0" [class.team-b]="i === 1">
            {{ score }}
          </div>
        </div>

        <div class="match-details">
          <div class="detail-item">
            <svg class="detail-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
              <circle cx="12" cy="10" r="3"/>
            </svg>
            <span>{{ matchDetails.info.venue }}, {{ matchDetails.info.city }}</span>
          </div>
          <div class="detail-item">
            <svg class="detail-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/>
              <line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
            <span>{{ matchDetails.info.dates[0] | date: 'd MMM yyyy' }}</span>
          </div>
        </div>
      </div>

      <div class="partnership-summary">
        <h3>Partnership Milestones</h3>
        <div class="milestone-stats">
          <div class="milestone-item" *ngFor="let key of [20, 25, 30, 35, 40, 45, 50]">
            <div class="milestone-number">{{ partnershipSummary[key] || 0 }}</div>
            <div class="milestone-label">{{ key }}+ runs</div>
          </div>
        </div>
      </div>
    </div>

    <div class="partnership-main">
      <div class="partnership-section">
        <div class="section-header">
          <h3>Partnership Tracker</h3>
          <div class="inning-selector">
            <label for="inningDropdown">Inning:</label>
            <div class="select-wrapper">
              <select id="inningDropdown" [(ngModel)]="selectedInningIndex" (change)="generatePartnerships()">
                <option *ngFor="let inn of availableInnings; let idx = index" [value]="idx">{{ inn }}</option>
              </select>
              <svg class="select-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="6,9 12,15 18,9"/>
              </svg>
            </div>
          </div>
        </div>

        <div class="partnership-table-container">
          <table class="partnership-table">
            <thead>
              <tr>
                <th>Wicket</th>
                <th>Batsmen</th>
                <th>Runs (Balls)</th>
                <th>Fall Over</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let p of partnerships; let i = index" [class.milestone]="p.runs >= 24">
                <td>
                  <div class="wicket-badge">{{ getWicketLabel(i) }}</div>
                </td>
                <td class="batsmen-cell">{{ p.batsmen }}</td>
                <td>
                  <div class="runs-info">
                    <span class="runs">{{ p.runs }}</span>
                    <span class="balls">({{ p.balls }})</span>
                  </div>
                </td>
                <td>{{ p.fallOver }}</td>
              </tr>
            </tbody>
          </table>
 </div>
      </div>
        </div>
      </div>
    </div>

<!-- Partnership Failures Modal -->
<div *ngIf="showFailurePopup" class="modal-overlay">
  <div class="modal-content failure-modal">
    <div class="modal-header">
      <div class="header-info">
        <h2>Partnership Failures</h2>
        <p class="subtitle">{{ selectedTournamentName }} | {{ selectedYear || 'N/A' }}</p>
        <div class="analysis-params">
          <span class="param-badge">{{ selectedRuns }}+ runs</span>
          <span class="param-badge">First {{ selectedWickets }} wickets</span>
        </div>
      </div>
      <button class="close-btn" (click)="showFailurePopup = false">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <div class="failure-stats">
        <div class="stat-card">
          <div class="stat-value">{{ allMatches.length || 0 }}</div>
          <div class="stat-label">Total Matches</div>
        </div>
        <div class="stat-card failure">
          <div class="stat-value">{{ failureMatches.length }}</div>
          <div class="stat-label">Failures</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">{{ countFailuresByInning(1) }}</div>
          <div class="stat-label">1st Innings</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">{{ countFailuresByInning(2) }}</div>
          <div class="stat-label">2nd Innings</div>
        </div>
        <div class="stat-card percentage">
          <div class="stat-value">{{ ((failureMatches.length / (allMatches.length || 1)) * 100) | number:'1.0-2' }}%</div>
          <div class="stat-label">Failure Rate</div>
        </div>
      </div>

      <div class="failure-breakdown" *ngIf="failureMatches.length > 0">
        <div class="breakdown-section">
          <h4>Top Failure Venues</h4>
          <div class="breakdown-list">
            <div class="breakdown-item" *ngFor="let venue of venueFailuresKeys().slice(0, 5)">
              <span class="item-name">{{ venue }}</span>
              <span class="item-count">{{ venueFailuresCount[venue] }}</span>
            </div>
          </div>
        </div>

        <div class="breakdown-section">
          <h4>Teams Most Affected</h4>
          <div class="breakdown-list">
            <div class="breakdown-item" *ngFor="let team of teamFailuresKeys().slice(0, 5)">
              <span class="item-name">{{ team }}</span>
              <span class="item-count">{{ teamFailuresCount[team] }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="failure-matches">
        <h3>Match Details</h3>
        <div class="failure-match" *ngFor="let match of failureMatches">
          <div class="failure-match-header">
            <h4>{{ match.matchName }} - {{ match.venue }}</h4>
            <div class="match-meta">
              <span class="inning-badge">Inning {{ match.inning }}</span>
              <span class="batting-team">{{ match.collapsedTeam }}</span>
            </div>
          </div>
          <div class="failure-table-container">
            <table class="failure-table">
              <thead>
                <tr>
                  <th>Wicket</th>
                  <th>Batsmen</th>
                  <th>Runs</th>
                  <th>Fall Over</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let p of match.partnerships">
                  <td>{{ p.wicket }}</td>
                  <td class="batsmen-cell">{{ p.batsmen }}</td>
                  <td>{{ p.runs }}</td>
                  <td>{{ p.fallOver }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Alert Modal -->
<div *ngIf="showAlert" class="modal-overlay">
  <div class="modal-content alert-modal">
    <div class="modal-header">
      <h3>Notice</h3>
      <button class="close-btn" (click)="closeAlert()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <p>{{ alertMessage }}</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" (click)="closeAlert()">OK</button>
    </div>
  </div>
</div>